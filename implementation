def encrypt_decrypt_machine():
    # Creating key strings
    keys = 'abcdefghijklmnopqrstuvwxyz !'
    # Auto-generating the values of strings
    # Value will be generated by taking last to first
    # Concatenated with the rest of the string
    values = keys[-1] + keys[0:-1]

    # Creating two dictionaries
    encrypt_dict = dict(zip(keys, values))
    decrypt_dict = dict(zip(values, keys))

    # User input with input validation
    while True:
        message = input("Enter your secret message: ")
        mode = input("Crypto Mode: Encode(E) or Decode(D): ").upper()

        if mode in ['E', 'D']:
            break
        else:
            print("Invalid choice. Please enter 'E' for Encode or 'D' for Decode.")

    # Encode and decode
    if mode == 'E':
        new_message = ''.join([encrypt_dict[letter] for letter in message.lower()])
    else:  # mode == 'D'
        new_message = ''.join([decrypt_dict[letter] for letter in message.lower()])

    return new_message.capitalize()

# Call the function and print the result
print(encrypt_decrypt_machine())
